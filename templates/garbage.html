


{% extends "base.html" %}

{% block content %}
    <div class="container">
        <h2>Countdown</h2>
        <div id="countdown-timer">
            <span id="timer">10</span>
        </div>
    </div>

    <script>
        let countdown = document.getElementById("timer");
        let countdownValue = parseInt(countdown.textContent);
        let countdownInterval = setInterval(() => {
            countdownValue -= 1;
            countdown.textContent = countdownValue;
            if (countdownValue === 0) {
                clearInterval(countdownInterval);
                // Transition to the next game state after the countdown finishes
                updateGameState();
            }
        }, 1000);
    </script>

    <script>
        function updateGameState() {
            // Replace this URL with the appropriate API URL for your application
            const url = `/game/state/update/${encodeURIComponent('{{ public_id }}')}/`;

            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}',
                },
                body: JSON.stringify({ 'new_state': 'QUESTION' }),
            })
                .then(response => {
                    if (response.ok) {
                        location.reload();
                    } else {
                        console.error('Error updating game state:', response);
                    }
                })
                .catch(error => {
                    console.error('Error fetching game state:', error);
                });
        }
    </script>
{% endblock %}

